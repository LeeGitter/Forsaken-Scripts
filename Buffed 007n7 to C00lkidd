local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")

local poisonedCheckRunning = true

-- Run the Buffs script immediately
local success, err = pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/LeeGitter/Forsaken-Scripts/refs/heads/main/007n7%20Buffs", true))()
end)
if not success then
    warn("Failed to load Buffs script:", err)
end

-- Function to disable animations for 0.5s and run first script
local function triggerPoisonEffect()
    -- Disable animations
    for _, track in ipairs(Humanoid.Animator:GetPlayingAnimationTracks()) do
        track:Stop()
    end
    Humanoid:SetStateEnabled(Enum.HumanoidStateType.Running, false)
    Humanoid:SetStateEnabled(Enum.HumanoidStateType.Walking, false)

    -- Run the first loadstring during the wait
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/LeeGitter/Forsaken-Scripts/refs/heads/main/007n7%20C00lkidd%20skin", true))()
    end)

    task.wait(0.5)

    -- Re-enable animations
    Humanoid:SetStateEnabled(Enum.HumanoidStateType.Running, true)
    Humanoid:SetStateEnabled(Enum.HumanoidStateType.Walking, true)
end

-- Watch for "Poisoned" folder
task.spawn(function()
    while poisonedCheckRunning and Character and Character.Parent do
        local buffsFolder = Character:FindFirstChild("Buffs")
        if buffsFolder and buffsFolder:FindFirstChild("Poisoned") then
            triggerPoisonEffect()
            -- Wait until Poisoned is gone before checking again
            repeat
                task.wait(0.1)
            until not (Character:FindFirstChild("Buffs") and Character.Buffs:FindFirstChild("Poisoned"))
        end
        task.wait(0.1)
    end
end)

-- Stop script on respawn
LocalPlayer.CharacterAdded:Connect(function()
    poisonedCheckRunning = false
end)
